import{Q as b,r as m,j as e,z as v,w as S,l as D,E as C,R as y,G as w,U as z,V as R,W as F,X as T,B as A,L,H as I}from"./index-TwdfaXd4.js";import{R as $}from"./RoundTripSearchHeader-uTG22TMr.js";import{P as O,a as _,b as f,c as q,d as B,e as E,L as M}from"./pagination-BFiW4Ks1.js";import"./chevron-left-BAFd-DeY.js";const H=(t,r)=>new Intl.NumberFormat("en-US",{style:"currency",currency:t}).format(parseFloat(r)),G=t=>t.replace("PT","").replace("H","H "),J=(t,r)=>{const s=new Date(r).getTime()-new Date(t).getTime(),l=Math.floor(s/(1e3*60*60)),n=Math.floor(s%(1e3*60*60)/(1e3*60));return`${l}h ${n}m`},U=t=>t===1?"non-stop":`${t-1} ${t-1===1?"stop":"stops"}`,K=t=>new Date(t).toLocaleDateString("en-GB",{day:"2-digit",month:"long",year:"numeric"}),u=10,X=({itinerary1:t,itinerary2:r,result:s})=>{const l=D(),[n,o]=m.useState(!1),g=async()=>{o(!0);try{const i=localStorage.getItem("confirmPriceToken");if(!i){alert("Authorization token is missing. Please log in again.");return}const h={data:{type:"flight-offers-pricing",flightOffers:[s]}},d=await fetch("https://test.ffsdtravels.com/api/flight/price/confirm",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${i}`},body:JSON.stringify(h)}),x=await d.json();if(d.ok){const{bookingRequirements:a,accessToken:c}=x.data;localStorage.setItem("payToken",c),localStorage.setItem("bookingRequirements",JSON.stringify(a)),localStorage.setItem("travelerRequirements",JSON.stringify(a.travelerRequirements)),localStorage.setItem("selectedFlight",JSON.stringify(s));const p=["emailAddressRequired","mobilePhoneNumberRequired"],j=Object.keys(a),k=j.length===p.length&&p.every(P=>j.includes(P));l(k?"/book-flight":"/book-flight2")}else alert(`Price confirmation failed: ${x.message||"Unknown error"} (Status: ${d.status})`)}catch(i){console.error("Error confirming price:",i),alert("An error occurred while confirming the price. Please try again.")}};return s.itineraries.length?e.jsx("div",{className:"flex flex-col gap-4",children:e.jsx(v,{className:"bg-white shadow-md p-4 rounded-sm",children:e.jsxs(C,{className:"p-0",children:[e.jsxs("div",{className:"p-2 border-b-2 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center lg:gap-3 md:gap-3 gap-1",children:[e.jsx("img",{src:`${y}${t.segments[0].airlineLogo}`,alt:`${t.segments[0].airlineName} logo`,className:"lg:w-10 md:w-10 sm:w-8 w-8 lg:h-10 md:h-10 sm:h-8 h-8 object-cover"}),e.jsx("div",{children:e.jsx("b",{className:"lg:text-base md:text-base sm:text-[10px] text-[11px]",children:t.segments[0].airlineName})})]}),e.jsx("div",{className:"flex lg:gap-5 gap-3 items-center",children:e.jsxs("div",{className:"text-end",children:[e.jsx("p",{className:"capitalize lg:text-sm text-[12px] font-medium",children:"Full pay"}),e.jsx("p",{className:"lg:text-sm text-[12px] sm:tracking-tight sm:leading-4 font-semibold text-gray-600",children:H(s.price.currency,s.price.ffsd_total)})]})})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"flex items-center lg:space-x-2 space-x-1 justify-between",children:e.jsxs("p",{className:"capitalize lg:text-base lg:w-[40%] w-[30%] text-[12px] text-gray-600",children:[e.jsx("span",{className:"font-bold text-black",children:"Departure Date"})," ",e.jsx("span",{className:"font-medium",children:K(t.segments[0].departure.at)}),e.jsx("span",{className:"mx-2 w-1 h-1 bg-gray-600 rounded-full"})]})}),e.jsxs("div",{className:"flex items-center justify-between lg:space-x-2 space-x-1 p-3 rounded-xs mt-2",children:[e.jsx("div",{className:"flex flex-col items-start w-[35%]",children:e.jsx("p",{className:"font-semibold text-gray-500 text-start capitalize tracking-tighter leading-4 lg:text-base text-[12px]",children:t.segments[0].departure_airport})}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(w,{}),e.jsx("p",{className:"font-bold text-start capitalize lg:text-lg text-[12px]",children:G(t.duration)}),e.jsx("p",{className:"font-semibold text-gray-500 text-end capitalize tracking-tighter leading-4 lg:text-base text-[8.5px]",children:U(t.segments.length)})]}),e.jsx("div",{className:"flex flex-col items-end w-[35%]",children:e.jsx("p",{className:"font-semibold text-gray-500 text-end capitalize tracking-tighter leading-4 lg:text-base text-[12px]",children:t.segments[t.segments.length-1].arrival_airport})})]})]}),e.jsx("hr",{}),e.jsx(z,{type:"single",collapsible:!0,className:"w-full",children:e.jsxs(R,{value:"item-1",className:"border-none",children:[e.jsx(F,{className:"font-medium px-2 capitalize",children:e.jsx("p",{className:"font-bold text-black capitalize",children:"Flight Details"})}),e.jsxs(T,{className:"p-4 flex flex-col gap-4 rounded-sm",children:[e.jsx("p",{className:"font-bold text-gray-700",children:"Outbound"}),t.segments.map(i=>e.jsx(N,{segment:i,travelerPricings:s.travelerPricings},i.id)),r&&e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"font-bold text-gray-700 mt-4",children:"Inbound"}),r.segments.map(i=>e.jsx(N,{segment:i,travelerPricings:s.travelerPricings},i.id)),e.jsx("div",{className:"flex mt-2 w-full justify-end",children:e.jsx(A,{className:"bg-primaryRed lg:text-sm text-[11px] hover:bg-black text-white",onClick:g,children:n?e.jsx(L,{color:"#FFFFFF",size:"20"}):"Book Flight"})})]})]})]})})]})})}):null},N=({segment:t,travelerPricings:r})=>e.jsxs("div",{className:"mt-3 bg-gray-100 rounded-xs",children:[e.jsxs("div",{className:"flex items-center lg:space-x-2 space-x-1 justify-between p-3 ",children:[e.jsxs("p",{className:"capitalize lg:text-base lg:w-[40%] w-[30%] text-[12px]  text-gray-600",children:[e.jsx("span",{className:"font-bold text-black",children:"Departure"})," ",e.jsx("span",{className:"font-medium",children:t.departure_airport})," ",e.jsx("span",{className:"w-2 h-2 bg-gray-600 rounded-full"}),e.jsx("span",{className:"font-bold text-black",children:new Date(t.departure.at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),e.jsxs("div",{className:"flex items-center lg:gap-3 md:gap-3 gap-1",children:[e.jsx("img",{src:`${y}${t==null?void 0:t.airlineLogo}`,alt:`${t==null?void 0:t.airlineName} logo`,className:"lg:w-10 md:w-10 sm:w-8 w-8 lg:h-10 md:h-10 sm:h-8 h-8 object-cover"}),e.jsx("div",{children:e.jsx("b",{className:"lg:text-base md:text-base sm:text-[10px] text-[11px]",children:t.airlineName})})]})]}),e.jsxs("div",{className:"flex flex-col gap-y-4 bg-gray-100 rounded-xs p-3  mt-2",children:[e.jsxs("div",{className:"flex items-center justify-between lg:space-x-2 space-x-1 w-full",children:[e.jsxs("div",{className:"flex flex-col items-start w-[35%]",children:[e.jsx("p",{className:"font-bold capitalize lg:text-sm text-[12px]",children:new Date(t.departure.at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}),e.jsx("p",{className:"font-semibold text-gray-500 text-start capitalize tracking-tighter leading-4 lg:text-base text-[8.5px]",children:t.departure_airport})]}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(w,{}),e.jsx("p",{className:"font-semibold text-gray-500 text-end capitalize tracking-tighter leading-4 lg:text-base text-[8.5px]",children:t.numberOfStops===0?"No stop":`${t.numberOfStops} stops`}),e.jsx("p",{className:"font-bold text-start capitalize lg:text-lg text-[12px]",children:J(t.departure.at,t.arrival.at)})]}),e.jsxs("div",{className:"flex flex-col items-end w-[35%]",children:[e.jsx("p",{className:"font-bold capitalize lg:text-sm text-[12px]",children:new Date(t.arrival.at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}),e.jsx("p",{className:"font-semibold text-gray-500 text-end capitalize tracking-tighter leading-4 lg:text-base text-[8.5px]",children:t.arrival_airport})]})]}),e.jsxs("div",{className:"flex items-center justify-between lg:space-x-2 space-x-1 w-full",children:[e.jsxs("div",{className:"flex flex-col items-start w-[35%]",children:[e.jsx("p",{className:"font-bold capitalize lg:text-sm text-[12px]",children:"Baggage"}),r.map((s,l)=>{var n,o;return e.jsx("div",{className:"w-full flex flex-col items-start",children:e.jsxs("p",{className:" flex font-semibold text-gray-500 text-start capitalize tracking-tighter leading-4 lg:text-base text-[12px]",children:[e.jsx(M,{}),((o=(n=s.fareDetailsBySegment[0])==null?void 0:n.includedCheckedBags)==null?void 0:o.quantity)??0," ","X 23kg"]})},l)})]}),e.jsxs("div",{className:"flex flex-col items-end w-[35%]",children:[e.jsx("p",{className:"font-bold capitalize lg:text-sm text-[12px]",children:"Airline"}),e.jsxs("p",{className:"font-semibold text-gray-500 text-start capitalize tracking-tighter leading-4 lg:text-base text-[8.5px]",children:[t.carrierCode," - ",t.number]})]})]})]})]}),Q=({searchData:t})=>{var d,x;const r=b(),s=Array.isArray((d=r.state)==null?void 0:d.searchResults)?r.state.searchResults:Object.values((x=r.state)==null?void 0:x.searchResults),[l,n]=m.useState(1),o=Math.ceil(s.length/u),g=(l-1)*u,i=g+u,h=s.slice(g,i);return s.length?e.jsxs("div",{className:"flex flex-col gap-3",children:[h.map(a=>e.jsx(X,{itinerary1:a.itineraries[0],itinerary2:a.itineraries[1],result:a},a.id)),e.jsx("div",{className:"flex justify-center mt-4",children:e.jsx(O,{children:e.jsxs(_,{children:[e.jsx(f,{children:e.jsx(q,{href:"#",onClick:a=>{a.preventDefault(),l>1&&n(l-1)}})}),Array.from({length:o},(a,c)=>e.jsx(f,{children:e.jsx(B,{href:"#",isActive:l===c+1,onClick:p=>{p.preventDefault(),n(c+1)},children:c+1})},c+1)),e.jsx(f,{children:e.jsx(E,{href:"#",onClick:a=>{a.preventDefault(),l<o&&n(l+1)}})})]})})})]}):e.jsxs(v,{className:"text-center bg-white shadow-md p-4 rounded-sm",children:[e.jsx(S,{className:"text-lg font-semibold mt-0",children:e.jsx("p",{className:"text-xl font-semibold",children:"No search results found."})}),e.jsx("p",{className:"text-gray-600 font-medium",children:"Please try adjusting your search criteria."})]})},ee=()=>{var d,x,a;const t=b(),s=(d=t.state)==null?void 0:d.searchResults,l=((x=t.state)==null?void 0:x.searchParams)||{departureCity:"",arrivalCity:"",departureDate:"",returnDate:"",adultCount:0,childCount:0,infantCount:0,selectedClass:""},[n,o]=m.useState(l),[g,i]=m.useState(s);m.useEffect(()=>{var c;(c=t.state)!=null&&c.searchParams&&o(t.state.searchParams)},[(a=t.state)==null?void 0:a.searchParams]);const h=m.useCallback(c=>{o(c)},[]);return m.useCallback(c=>{i(c)},[]),e.jsxs(e.Fragment,{children:[e.jsx(I,{}),e.jsxs("div",{className:"w-full overflow-hidden pt-4 section-width",children:[e.jsx("div",{className:"w-full lg:flex hidden",children:e.jsx($,{searchParams:n,onChange:h})}),e.jsx("div",{className:"flex flex-1 mt-3 gap-2 justify-between",children:e.jsx("div",{className:"w-full overflow-hidden px-4 my-3",children:e.jsx(Q,{searchData:g})})})]})]})};export{ee as default};
