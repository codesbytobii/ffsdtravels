import{Q as P,r as m,j as e,z as D,w as _,l as A,E as L,R as F,G as g,U as T,V as $,W as I,X as O,B as q,L as B,H as E}from"./index-DBncHmhw.js";import{R as M}from"./RoundTripSearchHeader-BgHzJLw4.js";import{P as H,a as G,b as v,c as J,d as U,e as K,L as X}from"./pagination-DLtqH2nf.js";import"./chevron-left-Bna9SWJ_.js";const Q=(t,l)=>new Intl.NumberFormat("en-US",{style:"currency",currency:t}).format(parseFloat(l)),f=t=>t.replace("PT","").replace("H","H "),V=(t,l)=>{const i=new Date(l).getTime()-new Date(t).getTime(),a=Math.floor(i/(1e3*60*60)),c=Math.floor(i%(1e3*60*60)/(1e3*60));return`${a}h ${c}m`},j=t=>t===1?"non-stop":`${t-1} ${t-1===1?"stop":"stops"}`,u=t=>new Date(t).toLocaleDateString("en-GB",{day:"2-digit",month:"long",year:"numeric"}),y=10,W=({itinerary1:t,itinerary2:l,itinerary3:i,itinerary4:a,itinerary5:c,result:r})=>{const d=A(),[p,h]=m.useState(!1),o=async()=>{h(!0);try{const s=localStorage.getItem("confirmPriceToken");if(!s){alert("Authorization token is missing. Please log in again.");return}const n={data:{type:"flight-offers-pricing",flightOffers:[r]}},x=await fetch("https://test.ffsdtravels.com/api/flight/price/confirm",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify(n)}),b=await x.json();if(x.ok){const{bookingRequirements:w,accessToken:S}=b.data;localStorage.setItem("payToken",S),localStorage.setItem("bookingRequirements",JSON.stringify(w)),localStorage.setItem("travelerRequirements",JSON.stringify(w.travelerRequirements)),localStorage.setItem("selectedFlight",JSON.stringify(r));const k=["emailAddressRequired","mobilePhoneNumberRequired"],z=Object.keys(w),C=z.length===k.length&&k.every(R=>z.includes(R));d(C?"/book-flight":"/book-flight2")}else alert(`Price confirmation failed: ${b.message||"Unknown error"} (Status: ${x.status})`)}catch(s){console.error("Error confirming price:",s),alert("An error occurred while confirming the price. Please try again.")}};return r.itineraries.length?e.jsx("div",{className:"flex flex-col gap-4",children:e.jsx(D,{className:"bg-white shadow-md p-4 rounded-sm",children:e.jsxs(L,{className:"p-0",children:[e.jsxs("div",{className:"p-2 border-b-2 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center lg:gap-3 md:gap-3 gap-1",children:[e.jsx("img",{src:`${F}${t.segments[0].airlineLogo}`,alt:`${t.segments[0].airlineName} logo`,className:"lg:w-10 md:w-10 sm:w-8 w-8 lg:h-10 md:h-10 sm:h-8 h-8 object-cover"}),e.jsx("div",{children:e.jsx("b",{className:"lg:text-base md:text-base sm:text-[10px] text-[11px]",children:t.segments[0].airlineName})})]}),e.jsx("div",{className:"flex lg:gap-5 gap-3 items-center",children:e.jsxs("div",{className:"text-end",children:[e.jsx("p",{className:"capitalize lg:text-sm text-[12px] font-medium",children:"Full pay"}),e.jsx("p",{className:"lg:text-sm text-[12px] sm:tracking-tight sm:leading-4 font-semibold text-gray-600",children:Q(r.price.currency,r.price.ffsd_total)})]})})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"flex items-center lg:space-x-2 space-x-1 justify-between",children:e.jsxs("p",{className:"capitalize lg:text-base lg:w-[40%] w-[30%] text-[12px] text-gray-600",children:[e.jsx("span",{className:"font-bold text-primaryRed",children:"Flight 1"})," "]})}),e.jsx("div",{className:"flex items-center lg:space-x-2 space-x-1 justify-between",children:e.jsxs("p",{className:"capitalize lg:text-base lg:w-[40%] w-[30%] text-[12px] text-gray-600",children:[e.jsx("span",{className:"font-bold text-black",children:"Departure Date"})," ",e.jsx("span",{className:"font-medium",children:u(t.segments[0].departure.at)}),e.jsx("span",{className:"mx-2 w-1 h-1 bg-gray-600 rounded-full"})]})}),e.jsxs("div",{className:"flex items-center justify-between lg:space-x-2 space-x-1 p-3 rounded-xs mt-2",children:[e.jsx("div",{className:"flex flex-col items-start w-[35%]",children:e.jsx("p",{className:"font-semibold text-gray-500 text-start capitalize tracking-tighter leading-4 lg:text-base text-[12px]",children:t.segments[0].departure_airport})}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(g,{}),e.jsx("p",{className:"font-bold text-start capitalize lg:text-lg text-[12px]",children:f(t.duration)}),e.jsx("p",{className:"font-semibold text-gray-500 text-end capitalize tracking-tighter leading-4 lg:text-base text-[8.5px]",children:j(t.segments.length)})]}),e.jsx("div",{className:"flex flex-col items-end w-[35%]",children:e.jsx("p",{className:"font-semibold text-gray-500 text-end capitalize tracking-tighter leading-4 lg:text-base text-[12px]",children:t.segments[t.segments.length-1].arrival_airport})})]}),e.jsx("hr",{}),l&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex items-center lg:space-x-2 space-x-1 justify-between",children:e.jsxs("p",{className:"capitalize lg:text-base lg:w-[40%] w-[30%] text-[12px] text-gray-600",children:[e.jsx("span",{className:"font-bold text-primaryRed",children:"Flight 2"})," "]})}),e.jsx("div",{className:"flex items-center lg:space-x-2 space-x-1 justify-between mt-4",children:e.jsxs("p",{className:"capitalize lg:text-base lg:w-[40%] w-[30%] text-[12px] text-gray-600",children:[e.jsx("span",{className:"font-bold text-black",children:"Departure Date"})," ",e.jsx("span",{className:"font-medium",children:u(l.segments[0].departure.at)}),e.jsx("span",{className:"mx-2 w-1 h-1 bg-gray-600 rounded-full"})]})}),e.jsxs("div",{className:"flex items-center justify-between lg:space-x-2 space-x-1 p-3 rounded-xs mt-2",children:[e.jsx("div",{className:"flex flex-col items-start w-[35%]",children:e.jsx("p",{className:"font-semibold text-gray-500 text-start capitalize tracking-tighter leading-4 lg:text-base text-[12px]",children:l.segments[0].departure_airport})}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(g,{}),e.jsx("p",{className:"font-bold text-start capitalize lg:text-lg text-[12px]",children:f(l.duration)}),e.jsx("p",{className:"font-semibold text-gray-500 text-end capitalize tracking-tighter leading-4 lg:text-base text-[8.5px]",children:j(l.segments.length)})]}),e.jsx("div",{className:"flex flex-col items-end w-[35%]",children:e.jsx("p",{className:"font-semibold text-gray-500 text-end capitalize tracking-tighter leading-4 lg:text-base text-[12px]",children:l.segments[l.segments.length-1].arrival_airport})})]})]}),e.jsx("hr",{}),i&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex items-center lg:space-x-2 space-x-1 justify-between",children:e.jsxs("p",{className:"capitalize lg:text-base lg:w-[40%] w-[30%] text-[12px] text-gray-600",children:[e.jsx("span",{className:"font-bold text-primaryRed",children:"Flight 3"})," "]})}),e.jsx("div",{className:"flex items-center lg:space-x-2 space-x-1 justify-between mt-4",children:e.jsxs("p",{className:"capitalize lg:text-base lg:w-[40%] w-[30%] text-[12px] text-gray-600",children:[e.jsx("span",{className:"font-bold text-black",children:"Departure Date"})," ",e.jsx("span",{className:"font-medium",children:u(i.segments[0].departure.at)}),e.jsx("span",{className:"mx-2 w-1 h-1 bg-gray-600 rounded-full"})]})}),e.jsxs("div",{className:"flex items-center justify-between lg:space-x-2 space-x-1 p-3 rounded-xs mt-2",children:[e.jsx("div",{className:"flex flex-col items-start w-[35%]",children:e.jsx("p",{className:"font-semibold text-gray-500 text-start capitalize tracking-tighter leading-4 lg:text-base text-[12px]",children:i.segments[0].departure_airport})}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(g,{}),e.jsx("p",{className:"font-bold text-start capitalize lg:text-lg text-[12px]",children:f(i.duration)}),e.jsx("p",{className:"font-semibold text-gray-500 text-end capitalize tracking-tighter leading-4 lg:text-base text-[8.5px]",children:j(i.segments.length)})]}),e.jsx("div",{className:"flex flex-col items-end w-[35%]",children:e.jsx("p",{className:"font-semibold text-gray-500 text-end capitalize tracking-tighter leading-4 lg:text-base text-[12px]",children:i.segments[i.segments.length-1].arrival_airport})})]})]}),e.jsx("hr",{}),a&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex items-center lg:space-x-2 space-x-1 justify-between",children:e.jsxs("p",{className:"capitalize lg:text-base lg:w-[40%] w-[30%] text-[12px] text-gray-600",children:[e.jsx("span",{className:"font-bold text-primaryRed",children:"Flight 4"})," "]})}),e.jsx("div",{className:"flex items-center lg:space-x-2 space-x-1 justify-between mt-4",children:e.jsxs("p",{className:"capitalize lg:text-base lg:w-[40%] w-[30%] text-[12px] text-gray-600",children:[e.jsx("span",{className:"font-bold text-black",children:"Departure Date"})," ",e.jsx("span",{className:"font-medium",children:u(a.segments[0].departure.at)}),e.jsx("span",{className:"mx-2 w-1 h-1 bg-gray-600 rounded-full"})]})}),e.jsxs("div",{className:"flex items-center justify-between lg:space-x-2 space-x-1 p-3 rounded-xs mt-2",children:[e.jsx("div",{className:"flex flex-col items-start w-[35%]",children:e.jsx("p",{className:"font-semibold text-gray-500 text-start capitalize tracking-tighter leading-4 lg:text-base text-[12px]",children:a.segments[0].departure_airport})}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(g,{}),e.jsx("p",{className:"font-bold text-start capitalize lg:text-lg text-[12px]",children:f(a.duration)}),e.jsx("p",{className:"font-semibold text-gray-500 text-end capitalize tracking-tighter leading-4 lg:text-base text-[8.5px]",children:j(a.segments.length)})]}),e.jsx("div",{className:"flex flex-col items-end w-[35%]",children:e.jsx("p",{className:"font-semibold text-gray-500 text-end capitalize tracking-tighter leading-4 lg:text-base text-[12px]",children:a.segments[a.segments.length-1].arrival_airport})})]})]}),e.jsx("hr",{}),c&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex items-center lg:space-x-2 space-x-1 justify-between",children:e.jsxs("p",{className:"capitalize lg:text-base lg:w-[40%] w-[30%] text-[12px] text-gray-600",children:[e.jsx("span",{className:"font-bold text-primaryRed",children:"Flight 5"})," "]})}),e.jsx("div",{className:"flex items-center lg:space-x-2 space-x-1 justify-between mt-4",children:e.jsxs("p",{className:"capitalize lg:text-base lg:w-[40%] w-[30%] text-[12px] text-gray-600",children:[e.jsx("span",{className:"font-bold text-black",children:"Departure Date"})," ",e.jsx("span",{className:"font-medium",children:u(c.segments[0].departure.at)}),e.jsx("span",{className:"mx-2 w-1 h-1 bg-gray-600 rounded-full"})]})}),e.jsxs("div",{className:"flex items-center justify-between lg:space-x-2 space-x-1 p-3 rounded-xs mt-2",children:[e.jsx("div",{className:"flex flex-col items-start w-[35%]",children:e.jsx("p",{className:"font-semibold text-gray-500 text-start capitalize tracking-tighter leading-4 lg:text-base text-[12px]",children:c.segments[0].departure_airport})}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(g,{}),e.jsx("p",{className:"font-bold text-start capitalize lg:text-lg text-[12px]",children:f(c.duration)}),e.jsx("p",{className:"font-semibold text-gray-500 text-end capitalize tracking-tighter leading-4 lg:text-base text-[8.5px]",children:j(c.segments.length)})]}),e.jsx("div",{className:"flex flex-col items-end w-[35%]",children:e.jsx("p",{className:"font-semibold text-gray-500 text-end capitalize tracking-tighter leading-4 lg:text-base text-[12px]",children:c.segments[c.segments.length-1].arrival_airport})})]})]})]}),e.jsx(T,{type:"single",collapsible:!0,className:"w-full",children:e.jsxs($,{value:"item-1",className:"border-none",children:[e.jsx(I,{className:"font-medium px-2 capitalize",children:e.jsx("p",{className:"font-bold text-black capitalize",children:"Flight Details"})}),e.jsxs(O,{className:"p-4 flex flex-col gap-4 rounded-sm",children:[e.jsx("p",{className:"font-bold text-gray-700",children:"Flight 1"}),t.segments.map(s=>e.jsx(N,{segment:s,travelerPricings:r.travelerPricings},s.id)),l&&e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"font-bold text-gray-700 mt-4",children:"Flight 2"}),l.segments.map(s=>e.jsx(N,{segment:s,travelerPricings:r.travelerPricings},s.id))]}),i&&e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"font-bold text-gray-700 mt-4",children:"Flight 3"}),i.segments.map(s=>e.jsx(N,{segment:s,travelerPricings:r.travelerPricings},s.id))]}),a&&e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"font-bold text-gray-700 mt-4",children:"Flight 4"}),a.segments.map(s=>e.jsx(N,{segment:s,travelerPricings:r.travelerPricings},s.id))]}),c&&e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"font-bold text-gray-700 mt-4",children:"Flight 5"}),c.segments.map(s=>e.jsx(N,{segment:s,travelerPricings:r.travelerPricings},s.id))]}),e.jsx("div",{className:"flex mt-2 w-full justify-end",children:e.jsx(q,{className:"bg-primaryRed lg:text-sm text-[11px] hover:bg-black text-white",onClick:o,children:p?e.jsx(B,{color:"#FFFFFF",size:"20"}):"Book Flight"})})]})]})})]})})}):null},N=({segment:t,travelerPricings:l})=>e.jsxs("div",{className:"mt-3 bg-gray-100 rounded-xs",children:[e.jsxs("div",{className:"flex items-center lg:space-x-2 space-x-1 justify-between p-3 ",children:[e.jsxs("p",{className:"capitalize lg:text-base lg:w-[40%] w-[30%] text-[12px]  text-gray-600",children:[e.jsx("span",{className:"font-bold text-black",children:"Departure"})," ",e.jsx("span",{className:"font-medium",children:t.departure_airport})," ",e.jsx("span",{className:"w-2 h-2 bg-gray-600 rounded-full"}),e.jsx("span",{className:"font-bold text-black",children:new Date(t.departure.at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),e.jsxs("div",{className:"flex items-center lg:gap-3 md:gap-3 gap-1",children:[e.jsx("img",{src:`${F}${t==null?void 0:t.airlineLogo}`,alt:`${t==null?void 0:t.airlineName} logo`,className:"lg:w-10 md:w-10 sm:w-8 w-8 lg:h-10 md:h-10 sm:h-8 h-8 object-cover"}),e.jsx("div",{children:e.jsx("b",{className:"lg:text-base md:text-base sm:text-[10px] text-[11px]",children:t.airlineName})})]})]}),e.jsxs("div",{className:"flex flex-col gap-y-4 bg-gray-100 rounded-xs p-3  mt-2",children:[e.jsxs("div",{className:"flex items-center justify-between lg:space-x-2 space-x-1 w-full",children:[e.jsxs("div",{className:"flex flex-col items-start w-[35%]",children:[e.jsx("p",{className:"font-bold capitalize lg:text-sm text-[12px]",children:new Date(t.departure.at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}),e.jsx("p",{className:"font-semibold text-gray-500 text-start capitalize tracking-tighter leading-4 lg:text-base text-[8.5px]",children:t.departure_airport})]}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(g,{}),e.jsx("p",{className:"font-semibold text-gray-500 text-end capitalize tracking-tighter leading-4 lg:text-base text-[8.5px]",children:t.numberOfStops===0?"No stop":`${t.numberOfStops} stops`}),e.jsx("p",{className:"font-bold text-start capitalize lg:text-lg text-[12px]",children:V(t.departure.at,t.arrival.at)})]}),e.jsxs("div",{className:"flex flex-col items-end w-[35%]",children:[e.jsx("p",{className:"font-bold capitalize lg:text-sm text-[12px]",children:new Date(t.arrival.at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}),e.jsx("p",{className:"font-semibold text-gray-500 text-end capitalize tracking-tighter leading-4 lg:text-base text-[8.5px]",children:t.arrival_airport})]})]}),e.jsxs("div",{className:"flex items-center justify-between lg:space-x-2 space-x-1 w-full",children:[e.jsxs("div",{className:"flex flex-col items-start w-[35%]",children:[e.jsx("p",{className:"font-bold capitalize lg:text-sm text-[12px]",children:"Baggage"}),l.map((i,a)=>{var c,r;return e.jsx("div",{className:"w-full flex flex-col items-start",children:e.jsxs("p",{className:"flex font-semibold text-gray-500 text-start capitalize tracking-tighter leading-4 lg:text-base text-[12px]",children:[e.jsx(X,{}),((r=(c=i.fareDetailsBySegment[0])==null?void 0:c.includedCheckedBags)==null?void 0:r.quantity)??0," ","X 23kg"]})},a)})]}),e.jsxs("div",{className:"flex flex-col items-end w-[35%]",children:[e.jsx("p",{className:"font-bold capitalize lg:text-sm text-[12px]",children:"Airline"}),e.jsxs("p",{className:"font-semibold text-gray-500 text-start capitalize tracking-tighter leading-4 lg:text-base text-[8.5px]",children:[t.carrierCode," - ",t.number]})]})]})]})]}),Y=({searchData:t})=>{var o,s;const l=P(),i=Array.isArray((o=l.state)==null?void 0:o.searchResults)?l.state.searchResults:Object.values((s=l.state)==null?void 0:s.searchResults),[a,c]=m.useState(1),r=Math.ceil(i.length/y),d=(a-1)*y,p=d+y,h=i.slice(d,p);return i.length?e.jsxs("div",{className:"flex flex-col gap-3",children:[h.map(n=>e.jsx(W,{itinerary1:n.itineraries[0],itinerary2:n.itineraries[1],itinerary3:n.itineraries[2],itinerary4:n.itineraries[3],itinerary5:n.itineraries[4],result:n},n.id)),e.jsx("div",{className:"flex justify-center mt-4",children:e.jsx(H,{children:e.jsxs(G,{children:[e.jsx(v,{children:e.jsx(J,{href:"#",onClick:n=>{n.preventDefault(),a>1&&c(a-1)}})}),Array.from({length:r},(n,x)=>e.jsx(v,{children:e.jsx(U,{href:"#",isActive:a===x+1,onClick:b=>{b.preventDefault(),c(x+1)},children:x+1})},x+1)),e.jsx(v,{children:e.jsx(K,{href:"#",onClick:n=>{n.preventDefault(),a<r&&c(a+1)}})})]})})})]}):e.jsxs(D,{className:"text-center bg-white shadow-md p-4 rounded-sm",children:[e.jsx(_,{className:"text-lg font-semibold mt-0",children:e.jsx("p",{className:"text-xl font-semibold",children:"No search results found."})}),e.jsx("p",{className:"text-gray-600 font-medium",children:"Please try adjusting your search criteria."})]})},ae=()=>{var o,s,n;const t=P(),i=(o=t.state)==null?void 0:o.searchResults,a=((s=t.state)==null?void 0:s.searchParams)||{departureCity:"",arrivalCity:"",departureDate:"",returnDate:"",adultCount:0,childCount:0,infantCount:0,selectedClass:""},[c,r]=m.useState(a),[d,p]=m.useState(i);m.useEffect(()=>{var x;(x=t.state)!=null&&x.searchParams&&r(t.state.searchParams)},[(n=t.state)==null?void 0:n.searchParams]);const h=m.useCallback(x=>{r(x)},[]);return m.useCallback(x=>{p(x)},[]),e.jsxs(e.Fragment,{children:[e.jsx(E,{}),e.jsxs("div",{className:"w-full overflow-hidden pt-4 section-width",children:[e.jsx("div",{className:"w-full lg:flex hidden",children:e.jsx(M,{searchParams:c,onChange:h})}),e.jsx("div",{className:"flex flex-1 mt-3 gap-2 justify-between",children:e.jsx("div",{className:"w-full overflow-hidden px-4 my-3",children:e.jsx(Y,{searchData:d})})})]})]})};export{ae as default};
